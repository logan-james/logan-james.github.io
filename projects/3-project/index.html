<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Wireshark | Logan's Lab </title> <meta name="author" content="Logan's Lab"> <meta name="description" content="Analyzing Network Traffic"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link defer href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://logan-james.github.io//projects/3-project/"> <script src="/assets/js/theme.js?a5ca4084d3b81624bcfa01156dae2b8e"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Logan's</span> Lab </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">Wireshark</h1> <p class="post-description">Analyzing Network Traffic</p> </header> <article> <h2 id="introduction">Introduction</h2> <p>If you’re entering the world of cybersecurity, network administration, or IT, Wireshark is an essential tool you’ll come across. Known as one of the most powerful network protocol analyzers, Wireshark allows users to capture and inspect packets in real-time, providing insights into network traffic that can be invaluable for troubleshooting, performance monitoring, or investigating security incidents. This blog post will introduce you to Wireshark, its capabilities, and explain some real-world examples using screenshots from a packet capture (PCAP) file analysis.</p> <h2 id="what-is-wireshark">What is Wireshark?</h2> <p>Wireshark is an open-source network protocol analyzer that enables users to see what’s happening on their network at a microscopic level. It captures network packets and displays them in detail, allowing you to examine their contents and identify various protocols. Wireshark is widely used in industries such as cybersecurity, networking, and IT support due to its powerful features, including:</p> <ul> <li> <strong>Packet Capture</strong>: Captures live network traffic or analyzes previously saved captures.</li> <li> <strong>Deep Packet Inspection</strong>: Inspects protocols like TCP, UDP, HTTP, DNS, FTP, and more.</li> <li> <strong>Filtering</strong>: Applies display filters to focus on specific traffic patterns or types.</li> <li> <strong>Statistics and Metrics</strong>: Provides insights into protocol hierarchy, endpoints, and conversations.</li> </ul> <p>Whether you’re diagnosing network issues, inspecting suspicious traffic, or understanding protocol behavior, Wireshark is the tool of choice.</p> <h2 id="setting-up-wireshark">Setting Up Wireshark</h2> <p>Before diving into analysis, let’s briefly walk through setting up Wireshark:</p> <ol> <li> <strong>Download and Installation</strong>: Wireshark can be downloaded for free from its <a href="https://www.wireshark.org/" rel="external nofollow noopener" target="_blank">official site</a>. It supports multiple platforms including Windows, macOS, and Linux.</li> <li> <strong>Starting a Capture</strong>: Launch Wireshark, select the appropriate network interface (e.g., Wi-Fi, Ethernet), and click “Start Capture.” Wireshark will begin capturing packets from the network.</li> <li> <strong>Applying Filters</strong>: To narrow down the traffic and focus on specific types, use Wireshark’s powerful display filters (e.g., <code class="language-plaintext highlighter-rouge">tcp</code>, <code class="language-plaintext highlighter-rouge">http</code>, or <code class="language-plaintext highlighter-rouge">ip.addr == 192.168.1.1</code>).</li> </ol> <h2 id="analyzing-a-pcap-file-a-walkthrough">Analyzing a PCAP File: A Walkthrough</h2> <p>To provide a hands-on example, we’ll analyze a captured file named <code class="language-plaintext highlighter-rouge">web server.pcap</code>. This file captures network traffic related to a session between two hosts, revealing details about their interactions using protocols like TCP and SMB2. Let’s explore this step by step, referring to the screenshots below.</p> <hr> <h2 id="screenshot-1-capture-file-properties">Screenshot 1: Capture File Properties</h2> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/wireshark1.jpeg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>In this screenshot, Wireshark provides an overview of the PCAP file properties:</p> <ul> <li> <strong>File Information</strong>: The file name is <code class="language-plaintext highlighter-rouge">web server.pcap</code>, with a size of 2283 KB and a snapshot length of 262,144 bytes, indicating the maximum size of captured packets.</li> <li> <strong>Time Frame</strong>: The capture started at <code class="language-plaintext highlighter-rouge">2023-09-10 11:13:06</code> and ended at <code class="language-plaintext highlighter-rouge">2023-09-10 11:27:37</code>, covering approximately 14 minutes of network activity.</li> <li> <strong>Statistics</strong>: <ul> <li> <strong>Packets Captured</strong>: 21,070 packets were captured in this timeframe.</li> <li> <strong>Average Packet Size</strong>: The average packet size is 92 bytes, which is typical for SMB traffic where messages are often relatively small.</li> <li> <strong>Bytes per Second</strong>: The capture shows an average throughput of 2,235 bytes per second.</li> </ul> </li> </ul> <p>This information provides context for the volume and nature of the traffic, helping an analyst estimate whether the amount of data exchanged aligns with expected behavior or indicates potential anomalies.</p> <h2 id="screenshot-2-packet-list-view">Screenshot 2: Packet List View</h2> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/wireshark2.jpeg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>This screenshot shows the packet list for the <code class="language-plaintext highlighter-rouge">web server.pcap</code> file. The view highlights communication between two IP addresses: <code class="language-plaintext highlighter-rouge">10.0.0.115</code> (source) and <code class="language-plaintext highlighter-rouge">10.0.0.105</code> (destination). Key observations include:</p> <ul> <li> <strong>TCP Handshake</strong>: The initial packets represent a standard TCP three-way handshake, where the source IP initiates a connection to the destination on port 445 (commonly used for SMB/CIFS services).</li> <li> <strong>SMB2 Protocol</strong>: Following the TCP connection, the traffic shifts to the SMB2 protocol, which is used for file sharing and remote administration on Windows networks. The list shows session setup requests and tree connect requests—typical operations for accessing shared resources or IPC paths.</li> <li> <strong>Error Messages</strong>: Errors such as <code class="language-plaintext highlighter-rouge">STATUS_NOT_FOUND</code> indicate the client attempted to access a non-existent path, useful for troubleshooting file share or permissions issues.</li> </ul> <h2 id="screenshot-3-protocol-hierarchy-statistics">Screenshot 3: Protocol Hierarchy Statistics</h2> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/wireshark3.jpeg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>This screenshot displays Wireshark’s Protocol Hierarchy Statistics feature, providing a breakdown of the different protocols captured:</p> <ul> <li> <strong>Ethernet and IPv4</strong>: All captured packets are under Ethernet and IPv4 layers, confirming local IPv4 network traffic.</li> <li> <strong>TCP (Transmission Control Protocol)</strong>: TCP traffic constitutes the majority, which is expected as SMB2 operates over TCP.</li> <li> <strong>SMB2 (Server Message Block version 2)</strong>: SMB2 traffic is significant, highlighting that file-sharing operations dominate this session.</li> <li> <strong>HTTP and SSH</strong>: Minimal HTTP and SSH packets are also present, suggesting occasional web-based activities or secure remote access attempts.</li> </ul> <p>The hierarchical view quickly reveals the protocol distribution, helping analysts focus on dominant or unexpected protocols.</p> <h2 id="screenshot-4-conversations-overview">Screenshot 4: Conversations Overview</h2> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/wireshark4.jpeg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>In this screenshot, the Conversations view shows the communication between IP addresses, breaking down the volume of packets, bytes transferred, and conversation duration:</p> <ul> <li> <strong>Top Conversations</strong>: The main conversation is between <code class="language-plaintext highlighter-rouge">14.0.0.120</code> and <code class="language-plaintext highlighter-rouge">10.0.0.112</code>, with significant data exchange (2 MB).</li> <li> <strong>Additional Details</strong>: Smaller conversations are also visible, such as between <code class="language-plaintext highlighter-rouge">10.0.0.105</code> and <code class="language-plaintext highlighter-rouge">10.0.0.115</code>, which are relevant to understanding the file-sharing activities. The duration column provides insight into how long each conversation lasted, which can indicate the persistence or briefness of certain connections.</li> </ul> <h2 id="screenshot-5-top-ips-and-ports">Screenshot 5: Top IPs and Ports</h2> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/wireshark5.jpeg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>The final screenshot displays the top IPs and ports involved in the capture:</p> <ul> <li> <strong>Top IP Addresses</strong>: <code class="language-plaintext highlighter-rouge">14.0.0.120</code> and <code class="language-plaintext highlighter-rouge">10.0.0.115</code> are identified as the most active IPs in this capture, indicating they are key participants in the session.</li> <li> <strong>Top Ports</strong>: The ports <code class="language-plaintext highlighter-rouge">51985</code> and <code class="language-plaintext highlighter-rouge">6180</code> are highlighted, suggesting these were the primary ports used for communication. Understanding these details helps analysts determine which services or applications are involved and whether the traffic pattern is typical or suspicious.</li> </ul> <h2 id="why-use-wireshark">Why Use Wireshark?</h2> <p>Wireshark is invaluable in many professional settings. Whether you’re monitoring a network for performance, identifying and mitigating potential attacks, or simply verifying network configuration, Wireshark provides the data needed to make informed decisions. Here are some use cases:</p> <ul> <li> <strong>Troubleshooting Network Issues</strong>: Analyze packet flows to identify latency issues, dropped connections, or misconfigured devices.</li> <li> <strong>Security Analysis</strong>: Detect suspicious activity like malware communication or unauthorized access attempts.</li> <li> <strong>Protocol Analysis</strong>: Understand how different protocols operate, making it easier to configure or debug network services.</li> </ul> <h2 id="conclusion">Conclusion</h2> <p>Wireshark is a must-have tool for anyone serious about network analysis, cybersecurity, or IT. Its ability to dissect traffic, provide detailed insights into protocols, and visualize network activity makes it essential for troubleshooting, forensics, and performance monitoring.</p> <p>This post aimed to introduce Wireshark through the analysis of a sample PCAP file. By exploring the details of this capture, we learned about TCP handshakes, SMB2 protocol interactions, and common errors that can be detected through packet inspection. I encourage you to download Wireshark and try capturing your own network traffic to gain hands-on experience!</p> <p>If you’re looking to add network analysis skills to your toolkit or further your career in IT or cybersecurity, mastering Wireshark is a great step forward.</p> </article> </div> </div> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2024 Logan's Lab. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?b7816bd189846d29eded8745f9c4cf77"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.min.js"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>